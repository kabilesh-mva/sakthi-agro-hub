import{j as e}from"./query-ClOPU3jo.js";import{r,e as w}from"./router-BUgJjUvb.js";import{N as S,F as C}from"./Footer-CeD08qhQ.js";import{C as F,c as L,d as b,a as I,B as A}from"./card-DVIgzTGa.js";import{I as m}from"./input-B0Y80hqP.js";import{L as u}from"./label-CD3SsN8m.js";import{a as E}from"./index-BV4ex-Is.js";import{s as n}from"./client-CtY_iIHf.js";import{h as P}from"./utils-CUBaLrxp.js";import"./vendor-BVORfsS8.js";import"./ui-Br0k5SbM.js";import"./supabase-DquKuMF8.js";const $=()=>{const[i,g]=r.useState(!0),[p,h]=r.useState(!1),[l,f]=r.useState(""),[o,v]=r.useState(""),[x,j]=r.useState(""),{toast:t}=E(),c=w();r.useEffect(()=>{(async()=>{const{data:{session:d}}=await n.auth.getSession();d&&c("/admin")})();const{data:{subscription:s}}=n.auth.onAuthStateChange((d,N)=>{N&&d==="SIGNED_IN"&&c("/admin")});return()=>s.unsubscribe()},[c]);const y=async a=>{a.preventDefault(),h(!0);try{if(i){const{error:s}=await n.auth.signInWithPassword({email:l,password:o});s?s.message.includes("Invalid login credentials")?t({title:"Login Failed",description:"Invalid email or password. Please try again.",variant:"destructive"}):t({title:"Login Failed",description:s.message,variant:"destructive"}):t({title:"Success",description:"Logged in successfully!"})}else{const{error:s}=await n.auth.signUp({email:l,password:o,options:{emailRedirectTo:`${window.location.origin}/`,data:{full_name:x}}});s?s.message.includes("already registered")?t({title:"Signup Failed",description:"This email is already registered. Please login instead.",variant:"destructive"}):t({title:"Signup Failed",description:s.message,variant:"destructive"}):t({title:"Success",description:"Account created successfully!"})}}catch(s){t({title:"Error",description:s.message||"An unexpected error occurred",variant:"destructive"})}finally{h(!1)}};return e.jsxs("div",{className:"min-h-screen flex flex-col",children:[e.jsx(S,{}),e.jsx("div",{className:"flex-1 flex items-center justify-center py-12 px-4",children:e.jsxs(F,{className:"w-full max-w-md",children:[e.jsx(L,{children:e.jsx(b,{className:"text-2xl text-center",children:i?"Admin Login":"Create Account"})}),e.jsxs(I,{children:[e.jsxs("form",{onSubmit:y,className:"space-y-4",children:[!i&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{htmlFor:"fullName",children:"Full Name"}),e.jsx(m,{id:"fullName",type:"text",placeholder:"John Doe",value:x,onChange:a=>j(a.target.value),required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{htmlFor:"email",children:"Email"}),e.jsx(m,{id:"email",type:"email",placeholder:"you@example.com",value:l,onChange:a=>f(a.target.value),required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{htmlFor:"password",children:"Password"}),e.jsx(m,{id:"password",type:"password",placeholder:"••••••••",value:o,onChange:a=>v(a.target.value),required:!0,minLength:6})]}),e.jsx(A,{type:"submit",className:"w-full",disabled:p,children:p?e.jsxs(e.Fragment,{children:[e.jsx(P,{className:"mr-2 h-4 w-4 animate-spin"}),"Please wait..."]}):e.jsx(e.Fragment,{children:i?"Login":"Sign Up"})})]}),e.jsx("div",{className:"mt-4 text-center text-sm",children:e.jsx("button",{type:"button",onClick:()=>g(!i),className:"text-primary hover:underline",children:i?"Don't have an account? Sign up":"Already have an account? Login"})})]})]})}),e.jsx(C,{})]})};export{$ as default};
